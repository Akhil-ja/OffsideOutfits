<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Offside Outfits</title>
    <meta name="keywords" content="HTML5 Template">
    <meta name="description" content="Molla - Bootstrap eCommerce Template">
    <meta name="author" content="p-themes">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href=" /productAssets/User-icon.svg">
    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- Main CSS File -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/plugins/owl-carousel/owl.carousel.css">
    <link rel="stylesheet" href="assets/css/plugins/magnific-popup/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/plugins/nouislider/nouislider.css">
    <link rel="stylesheet" href="path/to/sweetalert2.min.css">
</head>

<body>
    <div class="page-wrapper">
        <header class="header ">
            <div class="header-middle">
                <div class="header-top">
                    <div class="container-fluid">
                        <div class="header-left m-4">

                        </div><!-- End .header-left -->

                        <div class="header-right">
                            <ul class="top-menu">
                                
                            </ul><!-- End .top-menu -->
                        </div><!-- End .header-right -->
                    </div><!-- End .container-fluid -->
                </div><!-- End .header-top -->

                <div class="header-middle ">
                    <div class="container-fluid">
                        <div class="header-left">


                            <a href="/home" class="logo">
                                <img src="assets/images/Logo1.png" alt="Molla Logo" width="50" height="25">
                            </a>

                        <nav class="main-nav">
                            <ul class="menu sf-arrows">
                                <li class="megamenu-container ">
                                    <a href="/home" class="">Home</a>
                                </li>
                                <li class="">
                                    <a href="" class=" ">Shop</a>
                                </li>
                            </ul>
                        </nav>
                        </div><!-- End .header-left -->

                        <div class="header-right">

                            <div class="header-search">
                                <a href="#" class="search-toggle" role="button"><i class="icon-search"></i></a>
                                <form action="#" method="get">
                                    <div class="header-search-wrapper">
                                        <label for="q" class="sr-only">Search</label>
                                        <input type="search" class="form-control" name="q" id="q"
                                            placeholder="Search in..." required>
                                    </div><!-- End .header-search-wrapper -->
                                </form>
                            </div><!-- End .header-search -->

                            <a href="/wishlist" class="wishlist-link">
                                <i class="icon-heart-o"></i>
                            </a>

                            <div class=" cart-dropdown">
                                <a href="/cart" class="dropdown-toggle" role="button" aria-haspopup="true"
                                    aria-expanded="false" data-display="static">
                                    <i class="icon-shopping-cart"></i>
                                </a>
                            </div>

                            <div class=" cart-dropdown">
                                <a href="/profile" class="dropdown-toggle" role="button" aria-haspopup="true"
                                    aria-expanded="false" data-display="static">
                                    <i class="icon-user"></i>

                                </a>
                            </div>

                        </div><!-- End .header-right -->
                    </div><!-- End .container-fluid -->
                </div><!-- End .header-middle -->
            </div>
        </header><!-- End .header -->


<main class="main">
    <div class="page-header text-center" style="background-image: url('assets/images/page-header-bg.jpg')">
        <div class="container-fluid">
            <h1 class="page-title"><span>Wishlist</span></h1>
        </div>
    </div>
    <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 m-1"></nav>
    <div class="page-content">
        <div class="container-fluid">
            <div class="page-content">
                <div class="wishlist">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12">
                                <table class="table table-wishlist table-mobile">
                                    <thead>
                                        <tr>
                                            <th>Image</th>
                                            <th>Product</th>
                                            <th>Price</th>
                                            <th></th>
                                        </tr>
                                    </thead>

                            <tbody>
                                <% if (wishlistItems && wishlistItems.length> 0) { %>
                                    <% wishlistItems.forEach(wishlistItem=> { %>
                                        <tr data-wishlist-item="<%= wishlistItem._id %>" data-product-id="<%= wishlistItem._id %>">
                                            <td class="image-col">
                                                <img src="/productAssets/<%= wishlistItem.images[0] %>" alt="Product Image"
                                                    style="width: 50px; height: 50px;">
                                            </td>
                                            <td class="product-col">
                                                <div class="product">
                                                    <h3 class="product-title">
                                                        <a href="/products/<%= wishlistItem._id %>">
                                                            <%= wishlistItem.pname %>
                                                        </a>
                                                    </h3>
                                                </div>
                                            </td>
                                            <td class="price-col">
                                                <%= wishlistItem.price %>
                                            </td>


                                            <td>

                                        <select id="sizeDropdown" class="form-select"
                                            style="width: 70px; padding: 8px; border-radius: 5px; border-color: #ced4da; background-color: #fff;">
                                            <% wishlistItem.sizes.forEach(size=> { %>
                                                <% if (size.quantity> 0) { %>
                                                    <option value="<%= size.size %>">
                                                        <%= size.size %>
                                                    </option>
                                                    <% } else { %>
                                                        <option value="<%= size.size %>" disabled>
                                                            <%= size.size %> (Out of Stock)
                                                        </option>
                                                        <% } %>
                                                            <% }); %>
                                        </select>


                                            </td>

                                            <td class="add-to-cart-col">
                                                <a href="#" class="btn-product btn-cart" onclick="addToCart('<%= wishlistItem._id %>')">
                                                    <span>Add to Cart</span>
                                                </a>
                                            </td>
                                            <td class="remove-col">
                                                <button class="btn-remove" onclick="removeProductFromWishlist('<%= wishlistItem._id %>')">
                                                    <i class="icon-close"></i>
                                                </button>
                                            </td>
                                        </tr>
                                        <% }); %>
                                            <% } else { %>
                                                <tr>
                                                    <td colspan="5" class="text-center">
                                                        <div class="alert alert-warning">
                                                            <strong>Wishlist Is empty</strong>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <% } %>
                            </tbody>




                                </table>
                            </div><!-- End .col-lg-12 -->
                        </div><!-- End .row -->
                    </div><!-- End .container -->
                </div>
            </div><!-- End .page-content -->
        </div>
    </div>
</main>



    <footer class="footer footer-2">
        <div class="footer-middle">
            <div class="container">
                <div class="row justify-content-center"> <!-- Center aligning content -->
                    <div class="col-md-6">
                        <div class="widget widget-about text-center"> <!-- Center aligning content -->
                            <img style="margin-left: 120px;" src="assets/images/LogoFooter.png" class="footer-logo"
                                alt="Footer Logo" width="280" height="25">
                            <p>Offside Outfit is your premier destination for football jerseys, catering to the passion of
                                fans worldwide.
                                With a curated collection of high-quality gear representing teams from various leagues. Our
                                commitment to excellence ensures that every
                                garment is crafted with premium materials, guaranteeing comfort and durability on and off
                                the pitch.</p>
                        </div><!-- End .widget-about -->
                    </div><!-- End .col-md-6 -->
                </div><!-- End .row -->
            </div><!-- End .container -->
        </div><!-- End .footer-middle -->
    
        <div class="footer-bottom">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <p class="footer-copyright text-center">Copyright &copy; 2024 Offside Outfits. All Rights Reserved.
                        </p>
                    </div><!-- End .col-md-12 -->
                </div><!-- End .row -->
            </div><!-- End .container -->
        </div><!-- End .footer-bottom -->
    </footer>
        </div><!-- End .page-wrapper -->
        <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>
        
        <!-- Mobile Menu -->
        <div class="mobile-menu-overlay"></div><!-- End .mobil-menu-overlay -->
        
        <div class="mobile-menu-container">
            <div class="mobile-menu-wrapper">
                <span class="mobile-menu-close"><i class="icon-close"></i></span>
        
                <form action="#" method="get" class="mobile-search">
                    <label for="mobile-search" class="sr-only">Search</label>
                    <input type="search" class="form-control" name="mobile-search" id="mobile-search" placeholder="Search in..."
                        required>
                    <button class="btn btn-primary" type="submit"><i class="icon-search"></i></button>
                </form>
        
        
        
                <div class="social-icons">
                    <a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
                    <a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
                    <a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
                    <a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
                </div><!-- End .social-icons -->
            </div><!-- End .mobile-menu-wrapper -->
        </div><!-- End .mobile-menu-container -->
        
        
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/bootstrap.bundle.min.js"></script>
        <script src="assets/js/jquery.hoverIntent.min.js"></script>
        <script src="assets/js/jquery.waypoints.min.js"></script>
        <script src="assets/js/superfish.min.js"></script>
        <script src="assets/js/owl.carousel.min.js"></script>
        <script src="assets/js/bootstrap-input-spinner.js"></script>
        
        <script src="path/to/sweetalert2.all.min.js"></script>
        
        <script src="assets/js/main.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
        <script defer src="your-script.js"></script>
<script>
    function removeProductFromWishlist( productId) {
            fetch('/remove-from-wishlist', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                   
                    productId: productId
                })
            })
                .then(response => response.json())
                .then(result => {
                    console.log(result);

                   

                    window.location.reload(); 
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
</script>


<script>
    async function addToCart(productId) {
        const userId = '<%=currentUser._id %>';
        const size = document.getElementById('sizeDropdown').value;

        const data = {
            productId: productId,
            userId: userId,
            size: size,
        };

        try {
            const response = await fetch('/add-to-cart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const result = await response.json();

                if (result.alreadyExists) {
                    Swal.fire({
                        icon: 'info',
                        title: 'Already Exists',
                        text: 'This product is already in your cart.',
                    });
                } else {

                    const cartCountElement = document.getElementById('cart-count');
                    if (cartCountElement) {
                        cartCountElement.textContent = result.cartCount;
                    }

                    Swal.fire({
                        icon: 'success',
                        title: 'Added to Cart',
                        text: 'Product added to your cart successfully!',
                        showConfirmButton: false,
                        timer: 1000
                    });
                }
            } else {
                console.error('Failed to add product to cart');
            }
        } catch (error) {
            console.error('Error:', error);
        }
    }
</script>

        </body>
        
        
        </html>